Upstream-Status: Inappropriate [embedded specific]

From 66cce62487464e7fbfdb5350505d0b2c88f9be2c Mon Sep 17 00:00:00 2001
From: Andreas Oberritter <obi@opendreambox.org>
Date: Thu, 9 May 2019 13:11:04 +0200
Subject: [PATCH] update-alternatives: disable logging

By default, update-alternatives writes to /var/log/alternatives.log.
This causes errors on rootfs creation since recipe-sysroots were enabled.

Signed-off-by: Andreas Oberritter <obi@opendreambox.org>
---
 utils/update-alternatives.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/utils/update-alternatives.c b/utils/update-alternatives.c
index 4794cd807..fdf178296 100644
--- a/utils/update-alternatives.c
+++ b/utils/update-alternatives.c
@@ -100,7 +100,7 @@ enum output_mode {
 
 /* Action to perform */
 static enum action action = ACTION_NONE;
-static const char *log_file = LOGDIR "/alternatives.log";
+static const char *log_file;
 /* Skip alternatives properly configured in auto mode (for --config) */
 static int opt_skip_auto = 0;
 static int opt_verbose = OUTPUT_NORMAL;
@@ -490,7 +490,7 @@ log_msg(const char *fmt, ...)
 {
 	va_list args;
 
-	if (fh_log == NULL) {
+	if (fh_log == NULL && log_file != NULL) {
 		fh_log = fopen(log_file, "a");
 		if (fh_log == NULL && errno != EACCES)
 			syserr(_("cannot append to '%s'"), log_file);
